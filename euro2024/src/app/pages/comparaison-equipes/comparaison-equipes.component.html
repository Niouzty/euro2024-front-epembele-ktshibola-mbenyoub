<div class="container mx-auto p-4 md:p-6">
    <h2 class="text-xl md:text-2xl font-bold mb-4 md:mb-6">Comparaison d'Équipes</h2>
    
    <div class="flex flex-col space-y-4 md:space-y-0 md:flex-row md:space-x-4">
        <!-- Équipe 1 -->
        <div class="flex-1">
            <button 
                (click)="selectEquipe(1)" 
                class="w-full p-4 bg-blue-500 text-white rounded-lg shadow-md hover:bg-blue-600 transition-all duration-300
                       flex items-center justify-center border-2 border-transparent"
                [class.border-blue-300]="selectedEquipe === 1">
                <span class="text-lg font-semibold">
                    {{ equipe1 ? equipe1.nom : 'Équipe 1' }}
                </span>
                @if (selectedEquipe === 1) {
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                    </svg>
                }
            </button>
            
            @if (selectedEquipe === 1) {
                <div class="mt-2">
                    <select 
                        class="w-full p-2 border rounded-lg"
                        [(ngModel)]="equipe1"
                        (change)="onEquipeSelected(1)">
                        <option [ngValue]="null">Sélectionnez une équipe</option>
                        @for (equipe of availableEquipes1; track equipe.id_equipe) {
                            <option [ngValue]="equipe" [disabled]="isEquipeDisabled(equipe, 1)">
                                {{ equipe.nom }}
                            </option>
                        }
                    </select>
                </div>
            }
        </div>

        <!-- Équipe 2 -->
        <div class="flex-1">
            <button 
                (click)="selectEquipe(2)" 
                class="w-full p-4 bg-red-500 text-white rounded-lg shadow-md hover:bg-red-600 transition-all duration-300
                       flex items-center justify-center border-2 border-transparent"
                [class.border-red-300]="selectedEquipe === 2">
                <span class="text-lg font-semibold">
                    {{ equipe2 ? equipe2.nom : 'Équipe 2' }}
                </span>
                @if (selectedEquipe === 2) {
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                    </svg>
                }
            </button>
            
            @if (selectedEquipe === 2) {
                <div class="mt-2">
                    <select 
                        class="w-full p-2 border rounded-lg"
                        [(ngModel)]="equipe2"
                        (change)="onEquipeSelected(2)">
                        <option [ngValue]="null">Sélectionnez une équipe</option>
                        @for (equipe of availableEquipes2; track equipe.id_equipe) {
                            <option [ngValue]="equipe" [disabled]="isEquipeDisabled(equipe, 2)">
                                {{ equipe.nom }}
                            </option>
                        }
                    </select>
                </div>
            }
        </div>
    </div>

    <!-- Bouton de comparaison -->
    <div class="mt-6 text-center">
        <button 
            (click)="compareTeams()"
            [disabled]="!equipe1 || !equipe2 || isLoading"
            class="px-6 py-3 bg-green-500 text-white rounded-lg shadow-md hover:bg-green-600 transition-all duration-300
                   disabled:bg-gray-400 disabled:cursor-not-allowed">
            @if (isLoading) {
                <span>Chargement...</span>
            } @else {
                <span>Comparer les équipes</span>
            }
        </button>
    </div>

    <!-- Affichage des résultats -->
    @if (resultats) {
        <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6">
            <!-- Statistiques Équipe 1 -->
            <div class="bg-blue-50 p-4 rounded-lg">
                <h3 class="text-lg font-bold text-blue-800 mb-3">{{ resultats.equipe1.nom }}</h3>
                <div class="space-y-2">
                    <p>Matchs joués: <span class="font-bold">{{ resultats.equipe1.nombre_de_matchs }}</span></p>
                    <p>Buts (temps réglementaire): <span class="font-bold">{{ resultats.equipe1.buts_temps_reglementaire }}</span></p>
                    <p>Buts (prolongation): <span class="font-bold">{{ resultats.equipe1.buts_apres_prolongation }}</span></p>
                    <p>Tirs au but réussis: <span class="font-bold">{{ resultats.equipe1.buts_tirs_au_but }}</span></p>
                </div>
            </div>

            <!-- Comparaison -->
            <div class="bg-gray-50 p-4 rounded-lg">
                <h3 class="text-lg font-bold text-gray-800 mb-3">Comparaison</h3>
                <div class="space-y-2">
                    <p>
                        Différence de buts (TR): 
                        <span class="font-bold" [class.text-green-600]="resultats.comparaison.difference_buts_reglementaire > 0"
                                        [class.text-red-600]="resultats.comparaison.difference_buts_reglementaire < 0">
                            {{ resultats.comparaison.difference_buts_reglementaire }}
                        </span>
                    </p>
                    <p>
                        Différence de buts (Prol.): 
                        <span class="font-bold" [class.text-green-600]="resultats.comparaison.difference_buts_prolongation > 0"
                                        [class.text-red-600]="resultats.comparaison.difference_buts_prolongation < 0">
                            {{ resultats.comparaison.difference_buts_prolongation }}
                        </span>
                    </p>
                    <p>
                        Différence de tirs au but: 
                        <span class="font-bold" [class.text-green-600]="resultats.comparaison.difference_tirs_au_but > 0"
                                        [class.text-red-600]="resultats.comparaison.difference_tirs_au_but < 0">
                            {{ resultats.comparaison.difference_tirs_au_but }}
                        </span>
                    </p>
                    <p>
                        Différence de matchs: 
                        <span class="font-bold">{{ resultats.comparaison.difference_matchs_joues }}</span>
                    </p>
                </div>
            </div>

            <!-- Statistiques Équipe 2 -->
            <div class="bg-red-50 p-4 rounded-lg">
                <h3 class="text-lg font-bold text-red-800 mb-3">{{ resultats.equipe2.nom }}</h3>
                <div class="space-y-2">
                    <p>Matchs joués: <span class="font-bold">{{ resultats.equipe2.nombre_de_matchs }}</span></p>
                    <p>Buts (temps réglementaire): <span class="font-bold">{{ resultats.equipe2.buts_temps_reglementaire }}</span></p>
                    <p>Buts (prolongation): <span class="font-bold">{{ resultats.equipe2.buts_apres_prolongation }}</span></p>
                    <p>Tirs au but réussis: <span class="font-bold">{{ resultats.equipe2.buts_tirs_au_but }}</span></p>
                </div>
            </div>
        </div>
    }

    <!-- Message d'erreur -->
    @if (errorMessage) {
        <div class="mt-4 p-3 bg-red-100 text-red-800 rounded-lg">
            {{ errorMessage }}
        </div>
    }
</div>